I"<p>La <em>performance</em> es un factor importante en la calidad de una aplicaci贸n. Depende mucho de c贸mo codificamos y c贸mo est谩 configurada la infraestructura. Es importante, ya que impacta en la experiencia del usuario. Por su parte React ofrece mucha optimizaci贸n para dise帽ar aplicaciones de reacci贸n de alto rendimiento, que para que se luzca debemos seguir algunas buenas pr谩cticas.</p>

<h1 id="reactfragment"><a href="#header-1"></a>React.Fragment</h1>

<p>Muchas veces pasa que queremos renderizar un conjunto de elementos y para agruparlos se suelen poner dentro de un elemento padre <code class="language-plaintext highlighter-rouge">div</code>:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Content<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>Esto agrega un nodo extra al DOM, el cual es innecesario ya que solo tiene la funci贸n de agrupar elementos. Esto puede afectar a la <em>performance</em>.</p>

<p>Para agrupar elementos debemos usar <code class="language-plaintext highlighter-rouge">&lt;React.Fragment&gt;</code>, el cu谩l no agrega ning煤n nodo extra:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nc">React</span><span class="p">.</span><span class="nc">Fragment</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Content<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nc">React</span><span class="p">.</span><span class="nc">Fragment</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>React.Fragment tiene una sintaxis corta que es  &lt;&gt;&lt;/&gt;. Por lo que el c贸digo de arriba tambi茅n se puede escribir:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Content<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/&gt;</span>
</code></pre></div></div>

<h1 id="usar-el-empaquetado-en-modo--producci贸n"><a href="#header-1"></a>Usar el empaquetado en modo  Producci贸n</h1>

<p>Cuando se desarrolla una aplicaci贸n con React, se presentan advertencias y mensajes de errores muy 煤tiles. Estos hacen la identificaci贸n de bugs y problemas durante el desarrollo muy f谩cil. Pero tambi茅n cuestan parte del desempe帽o.</p>

<p>Si observas el c贸digo fuente de React, ver谩s muchas marcas de <code class="language-plaintext highlighter-rouge">if (process.env.NODE_ENV != 'production')</code>. Estos trozos de c贸digo que React est谩 ejecutando en tu ambiente de desarrollo no es algo que el usuario necesite. Para ambientes de producci贸n, todo este c贸digo innecesario se puede descartar.</p>

<p>Si impulsaste tu proyecto usando create-react-app, entonces puedes ejecutar <code class="language-plaintext highlighter-rouge">npm run build</code> para producir la construcci贸n de producci贸n sin este c贸digo extra. Si est谩s usando <em>webpack</em> puedes ejecutar <code class="language-plaintext highlighter-rouge">webpack -p</code> (el cual es el equivalente de <code class="language-plaintext highlighter-rouge">webpack --optimize-minimize --define process.env.NODE_ENV="'production'"</code>).</p>

<h1 id="implemente-el-m茅todo-shouldcomponentupdate"><a href="#header-1"></a>Implemente el m茅todo shouldComponentUpdate()</h1>

<p>Cuando una propiedad (<em>props</em>) o estado de un componente cambia, React decide si es necesario actualizar el DOM comparando el elemento reci茅n retornado con el previamente renderizado. Si no son iguales, React actualizar谩 el DOM.</p>

<p>Aunque React solo actualiza los nodos DOM modificados, el re-renderizado a煤n lleva algo de tiempo. En muchos casos no es un problema, pero si la desaceleraci贸n es notable puedes acelerar el proceso anulando la funci贸n del ciclo de vida shouldComponentUpdate, el cual se ejecuta antes de que el proceso de re-renderizado comience, es decir, cuando nuevos <em>props</em> son recibidos o alg煤n estado cambia. La implementaci贸n por defecto de esta funci贸n retorna true, permitiendo a React hacer la actualizaci贸n, incluso si ning煤n <em>props</em> o estado ha cambiado (los valores actuales y previos son los mismos).</p>

<p>Si sabes que en algunas situaciones tu componente no necesita actualizarse, puedes retornar false desde shouldComponentUpdate para omitir todo el proceso de renderizaci贸n, incluida la invocaci贸n de render() en este componente y debajo de 茅l.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">TestComponent</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">data</span><span class="p">:</span> <span class="dl">""</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">textvalue</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">data</span><span class="p">:</span> <span class="nx">value</span> <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">shouldComponentUpdate</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span> <span class="nx">nextState</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nextState</span><span class="p">.</span><span class="nx">data</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="k">return</span> <span class="kc">true</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Rendering</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="p">=</span><span class="s">"textvalue"</span> <span class="na">type</span><span class="p">=</span><span class="s">"text"</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="si">}</span><span class="p">&gt;</span>Click<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Si el c贸digo de arriba no tuviera el m茅todo shouldComponentUpdate implementado, el componente se vuelve a renderizar cada vez que se hace click en un bot贸n (incluso si el <em>input</em> de texto tiene el mismo valor).</p>

<h1 id="reactpurecomponent"><a href="#header-1"></a>React.PureComponent</h1>

<p>En lugar de implementar shouldComponentUpdate, podemos usar React.PureComponent.</p>

<p>Un React.PureComponent es lo mismo que un React.Component pero que implementa una funci贸n shouldComponentUpdate() con una comparaci贸n superficial. Es decir, chequea los <em>props</em> y los valores de los estados superficiales y decide si el componente necesita renderizar o no. De esta manera React.PureComponent optimiza los componentes de la clase reduciendo el n煤mero de renderizados no deseados.</p>

<p>Debido a que s贸lo hace una comparaci贸n superficial, no puede usarlo si las propiedades o el estado han sido mutados de una manera que una comparaci贸n superficial pasar铆a por alto. Esto puede ser un problema con estructuras de datos m谩s complejas.</p>

<p>Por ejemplo, en el siguiente c贸digo el problema es que PureComponent har谩 una comparaci贸n simple entre los valores antiguos y nuevos de this.props.words. Dado que este c贸digo muta la matriz wordsen el m茅todo handleClick de WordAdder, los valores antiguos y nuevos de this.props.words se comparar谩n como iguales, aunque las palabras actuales de la matriz hayan cambiado. La ListOfWords no se actualizar谩 a pesar de que tiene nuevas palabras que se deben renderizar.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">CounterButton</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PureComponent</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">button</span>
        <span class="na">color</span><span class="p">=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">color</span><span class="si">}</span>
        <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="na">count</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}))</span><span class="si">}</span><span class="p">&gt;</span>
        Count: <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Por lo tanto, React.PureComponent es 煤til solo cuando:</p>
<ul>
  <li><em>props</em> y estados contienen datos primitivos</li>
  <li><em>props</em> y estados tienen datos complejos pero saben cu谩ndo llamar a forceUpdate() para actualizar el componente</li>
</ul>

<p>La implementaci贸n de shouldComponentUpdate en el ejemplo anterior de TestComponent se podr铆a implementar como React.PureComponent de la siguiente manera:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">TestComponent</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PureComponent</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">data</span><span class="p">:</span> <span class="dl">""</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">textvalue</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">data</span><span class="p">:</span> <span class="nx">value</span> <span class="p">})</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Rendering</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="p">=</span><span class="s">"textvalue"</span> <span class="na">type</span><span class="p">=</span><span class="s">"text"</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="si">}</span><span class="p">&gt;</span>Click<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">data</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="usar-memorizaci贸n"><a href="#header-1"></a>Usar memorizaci贸n</h1>

<p>Memorizaci贸n es una t茅cnica de optimizaci贸n para incrementar la <em>performance</em> de la aplicaci贸n guardando los resultados y devolviendo el resultado en cach茅 cuando se repiten las mismas entradas.</p>

<p>React provee React.memo y useMemo para memorizaci贸n, los cu谩les guardan en cach茅 componentes.</p>

<p>React.memo es un componente de alto nivel para usar en componentes funcionales. Cuando el componente funcional se procesa usando React.Memo o useMemo, entonces su resultado se ha guardado en la memoria y la pr贸xima vez que se llame al componente con los mismos <em>props</em>, el resultado en cach茅 regresar谩 sin ninguna ejecuci贸n.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">UserDisplay</span> <span class="o">=</span> <span class="p">(</span><span class="nx">userDetails</span><span class="p">)</span> <span class="o">=&gt;</span><span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">,</span> <span class="nx">address</span><span class="p">}</span> <span class="o">=</span> <span class="nx">userDetails</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">name</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">age</span><span class="si">}</span> , <span class="si">{</span><span class="nx">address</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;/&gt;</span>
    <span class="p">)</span>
<span class="p">}</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(</span><span class="nx">UserDisplay</span><span class="p">);</span>
<span class="c1">// Primero - UserDisplay se llama y se ejecuta, luego se procesa.</span>
<span class="p">&lt;</span><span class="nc">UserDisplay</span>
  <span class="na">name</span><span class="p">=</span><span class="s">"Test"</span>
  <span class="na">age</span><span class="p">=</span><span class="s">"30"</span>
  <span class="na">address</span><span class="p">=</span><span class="s">"Test address"</span>
<span class="p">/&gt;</span>
<span class="c1">// Segundo - El resultado almacenado en cach茅 se procesar谩 sin ninguna ejecuci贸n.</span>
<span class="p">&lt;</span><span class="nc">UserDisplay</span>
  <span class="na">name</span><span class="p">=</span><span class="s">"Test"</span>
  <span class="na">age</span><span class="p">=</span><span class="s">"30"</span>
  <span class="na">address</span><span class="p">=</span><span class="s">"Test address"</span>
<span class="p">/&gt;</span>
<span class="c1">// Tercero - UserDisplay se llama y se ejecuta, luego se procesa.</span>
<span class="c1">// Porque aqu铆 el valor *name* es diferente.</span>
<span class="p">&lt;</span><span class="nc">UserDisplay</span>
  <span class="na">name</span><span class="p">=</span><span class="s">"New Test"</span>
  <span class="na">age</span><span class="p">=</span><span class="s">"30"</span>
  <span class="na">address</span><span class="p">=</span><span class="s">"Test address"</span>
<span class="p">/&gt;</span>
</code></pre></div></div>

<h1 id="code-splitting"><a href="#header-1"></a><em>Code Splitting</em></h1>

<p>Primero es importante entender el concepto de <em>Lazy loading</em>, el cu谩l indica que los recursos (ima堑enes, <em>scripts</em>, etc.) deber铆an ser cargados cuando realmente se necesitan. En lugar de cargar una p谩gina web entera y renderizarla en el navegador todo de una vez, solo renderiza los componente cr铆ticos primero y luego aquellos componentes restantes o cuando se vayan requiriendo. De esta manera no perdemos tiempo ni memoria en procesos que no beneficiar谩n la experiencia del usuario del producto.</p>

<p><em>Code Splitting</em> es una t茅cnica en la cual podemos tratar costos de cargar Javascript y cumplir con el concepto de <em>lazy loading</em> al mismo tiempo.  En lugar de entregar tu aplicaci贸n en un 煤nico archivo, se divide en varios archivos.</p>

<h2 id="webpack"><a href="#header-2"></a>Webpack</h2>

<p>La forma en que le indicamos a <em>webpack</em> que queremos dividir un c贸digo en paquetes separados es mediante <em>dynamic imports</em>. La palabra clave <em>import</em> se puede usar como una funci贸n que toma la ruta del m贸dulo que queremos dividir en un paquete separado y devuelve una <em>promise</em>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">/module/name/here</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">module</span> <span class="o">=&gt;</span> <span class="p">...)</span>
</code></pre></div></div>

<p>Cuando el m贸dulo es cargado y la promesa resulta, podemos acceder a lo que exporta.</p>

<h2 id="react"><a href="#header-2"></a>React</h2>

<p>React provee dos elementos para implementarlo:</p>

<ul>
  <li>React.lazy() - React.lazy() es la funci贸n que permite implementar la importaci贸n din谩mica para componentes regulares en React.</li>
  <li>React.Suspense - React.suspense tiene una propiedad <em>fallback</em> que toma el elemento react que quiere renderizar mientras el componente se carga usando React.lazy.</li>
</ul>

<h2 id="niveles"><a href="#header-2"></a>Niveles</h2>

<p>Existen diferentes paradigmas de <em>code splitting</em>. Algunos de los m谩s comunes y que se pueden combinar son:</p>

<h3 id="dividir-por-rutas"><a href="#header-3"></a>Dividir por rutas</h3>

<p>Es uno de los enfoques m谩s comunes. Esto nos dejar谩 con un paquete separado para cada ruta de nivel superior. Por ejemplo:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span><span class="nx">Suspense</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Switch</span><span class="p">,</span> <span class="nx">BrowserRouter</span> <span class="k">as</span> <span class="nx">Router</span><span class="p">,</span> <span class="nx">Route</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-router-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">importedComponent</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-imported-component</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Home</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Home</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Loading</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Loading</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">AsyncDynamicPAge</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">lazy</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="cm">/* webpackChunkName:'DynamicPage' */</span> <span class="dl">'</span><span class="s1">./DynamicPage</span><span class="dl">'</span><span class="p">));</span>
<span class="kd">const</span> <span class="nx">AsyncNoMatch</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">lazy</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="cm">/* webpackChunkName:'NoMatch' */</span> <span class="dl">'</span><span class="s1">./NoMatch</span><span class="dl">'</span><span class="p">));</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">Router</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Suspense</span> <span class="na">fallback</span><span class="p">=</span><span class="si">{</span><span class="nx">Loading</span><span class="si">}</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nc">Switch</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">exact</span> <span class="na">path</span><span class="p">=</span><span class="s">"/"</span> <span class="na">component</span><span class="p">=</span><span class="si">{</span><span class="nx">Home</span><span class="si">}</span><span class="p">/&gt;</span>
                    <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">exact</span> <span class="na">path</span><span class="p">=</span><span class="s">"/dynamic"</span> <span class="na">component</span><span class="p">=</span><span class="si">{</span><span class="nx">AsyncDynamicPAge</span><span class="si">}</span><span class="p">/&gt;</span>
                    <span class="p">&lt;</span><span class="nc">Route</span> <span class="na">component</span><span class="p">=</span><span class="si">{</span><span class="nx">AsyncNoMatch</span><span class="si">}</span><span class="p">/&gt;</span>
                <span class="p">&lt;/</span><span class="nc">Switch</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nc">Suspense</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nc">Router</span><span class="p">&gt;</span>
    <span class="p">)</span>
        <span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<p>Esto crear谩 tres paquetes, uno para el componente DynamicPage, uno para el componente NoMatch y otro para la aplicaci贸n principal.</p>

<p>Cambiemos tambi茅n el nombre del archivo del paquete. En el archivo webpack.config.js se deber铆a cambiar de la siguiente manera:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">filename</span><span class="p">:</span> <span class="dl">'</span><span class="s1">[name].[hash].js</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="dividir-por-vendor"><a href="#header-3"></a>Dividir por <em>Vendor</em></h3>

<p>Dividamos la aplicaci贸n por <em>vendor</em>. En el archivo webpack.config.js se debe agregar lo siguiente:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">vendor</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">semantic-ui-react</span><span class="dl">'</span><span class="p">],</span>
    <span class="na">app</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./src/index.js</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="p">...</span>
  <span class="na">optimization</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">splitChunks</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">cacheGroups</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">styles</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">styles</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">css$/</span><span class="p">,</span>
          <span class="na">chunks</span><span class="p">:</span> <span class="dl">'</span><span class="s1">all</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">enforce</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="na">vendor</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">chunks</span><span class="p">:</span> <span class="dl">'</span><span class="s1">initial</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">test</span><span class="p">:</span> <span class="dl">'</span><span class="s1">vendor</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">vendor</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">enforce</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">};</span>
</code></pre></div></div>

<ul>
  <li>entry.vendor: [semantic-ui-react]: especifica qu茅 biblioteca queremos extraer de nuestra aplicaci贸n principal.</li>
  <li>optimization: si omite esta entrada, <em>webpack</em> a煤n dividir谩 su aplicaci贸n por <em>vendor</em>, sin embargo, los tama帽os de los paquetes ser谩n grandes. En cambio, agregando esta entrada, los tama帽os de los paquetes se reducir谩n significativamente.</li>
</ul>

<p>Este tipo de <em>code splitting</em> te ayudar谩 de dos maneras. Ayuda al buscador a almacenar aquellos recursos que cambian con menos frecuencia. Tambi茅n ayudar谩 al buscador a tomar ventaja de la descarga paralela para reducir, potencialmente, el tiempo de carga.</p>

<h3 id="extraer-estilos-css"><a href="#header-3"></a>Extraer estilos Css</h3>

<p>Al usar ExtractTextWebpackPlugin, puedes extraer todo c贸digo CSS a un archivo CSS separado. Tambi茅n se obtienen en general los mismos beneficios que el nivel anterior.</p>

<h1 id="usar-componentes-functionalesstateless"><a href="#header-1"></a>Usar Componentes Functionales/<em>Stateless</em></h1>

<p>El componente funcional evita la construcci贸n de la instancia de clase. Reduce el tama帽o general del paquete mejor que las clases.</p>

<h1 id="virtualizar-listas-largas"><a href="#header-1"></a>Virtualizar listas largas</h1>

<p>Si su aplicaci贸n renderiza largas listas de datos (cientos o miles de filas), recomendamos que uses una t茅cnica conocida como <em>windowing</em>. Esta t茅cnica solo renderiza un peque帽o subconjunto de tus filas en un momento dado, y puede reducir dram谩ticamente el tiempo que demora en re-renderizar los componentes, as铆 como el numero de nodos creados en el DOM.</p>

<p><a href="https://react-window.vercel.app/#/examples/list/fixed-size">react-window</a> y <a href="https://bvaughn.github.io/react-virtualized/#/components/List">react-virtualized</a> son bibliotecas de <em>windowing</em> populares. Estas proveen varios componentes reusables para mostrar listas, grillas y datos tabulares.</p>

<h1 id="throttling-y-debouncing"><a href="#header-1"></a><em>Throttling</em> y <em>Debouncing</em></h1>

<p><em>Throttling</em> y <em>Debouncing</em> son conceptos de optimizaci贸n importantes para evitar hacer m煤ltiples llamadas a APIs.</p>

<h2 id="throttling"><a href="#header-2"></a>Throttling</h2>

<p><em>Throttling</em> significa ejecutar la funci贸n a intervalos regulares, lo que significa que una vez que se ejecuta la funci贸n, comenzar谩 de nuevo solo despu茅s de que haya transcurrido un per铆odo de tiempo espec铆fico.</p>

<h3 id="implementar-con-lodash"><a href="#header-3"></a>Implementar con <em>lodash</em></h3>

<p>Primero instalar lodash:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">lodash</span>
</code></pre></div></div>

<p>La implementaci贸n de <em>throttling</em> para un componente que se encarga de autocompletar:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">throttle</span> <span class="p">}</span> <span class="k">from</span> <span class="nx">lodash</span><span class="p">;</span><span class="kd">class</span> <span class="nx">autocomp</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">results</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">handleInputThrottled</span> <span class="o">=</span> <span class="nx">throttle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handleInput</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>    <span class="nx">handleInput</span> <span class="o">=</span> <span class="nx">evt</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span>
        <span class="kd">const</span> <span class="nx">filteredRes</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">// algoritmo para buscar a trav茅s del array `data`</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">results</span><span class="p">:</span> <span class="nx">filteredRes</span> <span class="p">})</span>
    <span class="p">}</span>    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="p">{</span> <span class="nx">results</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">'</span><span class="s1">autocomp_wrapper</span><span class="dl">'</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Enter your search..</span><span class="dl">"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleInputThrottled</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="nx">results</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">result</span><span class="o">=&gt;</span><span class="p">{</span><span class="nx">result</span><span class="p">})}</span>
                <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>La funci贸n <em>throttle</em> se le pasa una funci贸n que quiere ser <em>throttled</em> y la cantidad de tiempo que debe ser <em>throttled</em>, esto devuelve una funci贸n que est谩 <em>throttled</em>. En nuestro caso, el m茅todo handleInput se pasa a la funci贸n <em>throttle</em> y queremos que se acelere a 100 ms.</p>

<p>Ahora, si escribimos fidudusola a una velocidad normal de 1 letra por 200ms. En nuestra composici贸n <em>throttled</em>, se necesitar铆an 10 * 200ms = (2000ms) 2s para escribir fidudusola, donde el m茅todo handleInput se llamar铆a 2 (2000ms / 100ms = 2) veces en lugar de 10 veces si nuestro componente de autocomp no se le hubiera aplicado <em>throttled</em>.</p>

<h2 id="debouncing"><a href="#header-2"></a>Debouncing</h2>

<p><em>Debouncing</em> significa que la funci贸n se ejecutar谩 cuando un usuario no haya realizado un evento en un per铆odo de tiempo espec铆fico. Ignora todas las llamadas a una funci贸n y espera hasta que la funci贸n deje de llamarse durante un per铆odo de tiempo espec铆fico.</p>

<h3 id="implementar-con-lodash-1"><a href="#header-3"></a>Implementar con <em>lodash</em></h3>

<p>Primero instalar lodash:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">lodash</span>
</code></pre></div></div>

<p>La implementaci贸n de <em>throttling</em> para un componente que se encarga de autocompletar:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">debounce</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">lodash</span><span class="dl">'</span><span class="p">;</span><span class="kd">class</span> <span class="nx">autocomp</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">results</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">handleInputThrottled</span> <span class="o">=</span> <span class="nx">debounce</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handleInput</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>    <span class="nx">handleInput</span> <span class="o">=</span> <span class="nx">evt</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span>
        <span class="kd">const</span> <span class="nx">filteredRes</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
             <span class="c1">// algoritmo para buscar a trav茅s del array `data`</span>
        <span class="p">})</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">results</span><span class="p">:</span> <span class="nx">filteredRes</span> <span class="p">})</span>
    <span class="p">}</span>    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="p">{</span> <span class="nx">results</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">'</span><span class="s1">autocomp_wrapper</span><span class="dl">'</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Enter your search..</span><span class="dl">"</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleInputThrottled</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="nx">results</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">result</span><span class="o">=&gt;</span><span class="p">{</span><span class="nx">result</span><span class="p">})}</span>
                <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="activar-gzip-en-tu-servidor-web"><a href="#header-1"></a>Activar Gzip en tu Servidor Web</h1>

<p>El grupo de archivos JS de la aplicaci贸n React son, com煤nmente, muy grandes as铆 que para hacer que la p谩gina web cargue m谩s r谩pido, podemos activar Gzip en el servidor web (Apache, Nginx, etc.)</p>

<p>Todos los buscadores modernos apoyan y negocian autom谩ticamente la compresi贸n de Gzip para las peticiones HTTP. Activar la compresi贸n Gzip puede reducir el tama帽o de la respuesta transferida en un 90%, lo cual puede reducir la cantidad de tiempo para descargar un recurso, reducir el uso de data para el cliente y mejorar el tiempo para la renderizaci贸n de tus p谩ginas.</p>

<p>Verifica la documentaci贸n para tu servidor web para ver c贸mo activar la compresi贸n:</p>

<ul>
  <li>Apache: Usa <a href="http://httpd.apache.org/docs/current/mod/mod_deflate.html">mod_deflate</a></li>
  <li>Nginx: Usa <a href="https://nginx.org/en/docs/http/ngx_http_gzip_module.html">ngx_http_gzip_module</a></li>
</ul>

<h1 id="herramientas-煤tiles"><a href="#header-1"></a>Herramientas tiles</h1>

<h2 id="react-addons-perf"><a href="#header-2"></a>react-addons-perf</h2>

<p>react-addons-perf te permite obtener un resumen del desempe帽o general de tu aplicaci贸n.</p>

<p>El uso es el siguiente:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Import</span> <span class="nx">Perf</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-addons-perf</span><span class="dl">'</span>
<span class="nx">Perf</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
<span class="c1">// use the app</span>
<span class="nx">Perf</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
<span class="nx">Perf</span><span class="p">.</span><span class="nx">printWasted</span><span class="p">();</span>
</code></pre></div></div>

<p>Esto imprimir谩 una tabla con la cantidad de componentes de tiempo perdido al renderizar.</p>

<p>La librer铆a proporciona otras funciones que te permiten imprimir diferentes aspectos del tiempo perdido por separado (ej., al usar las funciones printInclusive() o printExclusive()), o hasta imprimir las operaciones de manipulaci贸n DOM (usando la funci贸n printOperations()).</p>

<p>Para m谩s detalle ver <a href="https://reactjs.org/docs/perf.html">aqu铆</a></p>

<h2 id="webpack-bundle-analyzer"><a href="#header-2"></a>Webpack Bundle Analyzer</h2>

<p>Realmente no podemos hablar de <em>performance</em> a menos que haya algo que podamos medir. Para saber d贸nde mejorar, necesitamos tener algunas ideas. En el contexto del <em>code splitting</em>, debemos ser conscientes de qu茅 tan grandes son nuestros paquetes y qu茅 hay realmente en ellos.</p>

<p><em>Webpack Bundle Analyzer</em> proporciona una representaci贸n visual de los paquetes de tu aplicaci贸n para que pueda ver qu茅 va en cada uno.</p>

<p>Para m谩s detalle ver <a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">aqu铆</a></p>

<h1 id="fuentes"><a href="#header-1"></a>Fuentes</h1>

<ul>
  <li><a href="https://hackernoon.com/lessons-learned-code-splitting-with-webpack-and-react-f012a989113">Lessons Learned: Code Splitting with Webpack and React</a></li>
  <li><a href="https://www.freecodecamp.org/news/learn-webpack-for-react-a36d4cac5060/">How to use Webpack with React: an in-depth tutorial</a></li>
  <li><a href="https://es.reactjs.org/docs/optimizing-performance.html">Optimizando el Rendimiento</a></li>
  <li><a href="https://www.c-sharpcorner.com/article/performance-optimization-techniques-for-react-applications/">Performance Optimization Techniques For React Applications</a></li>
  <li><a href="https://blog.bitsrc.io/improve-your-react-app-performance-by-using-throttling-and-debouncing-101afbe9055">Improve Your React App Performance by Using Throttling and Debouncing</a></li>
  <li><a href="https://medium.com/swlh/9-performance-optimization-strategies-for-reactjs-development-36f6d03a0912">9 Performance Optimization Strategies for ReactJS Development</a></li>
  <li><a href="https://www.toptal.com/react/componentes-react-eficientes-una-guia-para-optimizar-el-desempeno-de-react">Componentes React Eficientes: Una Gu铆a para Optimizar el Desempe帽o de React</a></li>
</ul>
:ET